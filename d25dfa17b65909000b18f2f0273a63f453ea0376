v3 -> v4:
* fall back to v1, fixing only missing XDP_PACKET_HEADROOM in pad and
  removing bpf_xdp_adjust_tail() check for frame_sz.
* added rcu read lock, noted by Jason Wang <jasowang@redhat.com> in v1
* I decided to leave the packet length check in tun_can_build_skb()
  instead of moving to tun_build_skb() suggested by Jason Wang
  <jasowang@redhat.com>. Otherwise extra packets will be dropped
  without falling back to tun_alloc_skb(). And in the discussion of v3
  Jesper Dangaard Brouer <jbrouer@redhat.com> noticed that XDP is ok
  with a higher order pages if it's a contiguous physical memory
  allocation, so falling to tun_alloc_skb() -> do_xdp_generic() should
  be ok.

v2 -> v3:
* attach the forgotten changelog

v1 -> v2:
* merged 2 patches in 1, fixing both issues: WARN_ON_ONCE with
  syzkaller repro and missing XDP_PACKET_HEADROOM in pad
* changed the title and description of the execution path, suggested
  by Jason Wang <jasowang@redhat.com>
* move the limit check from tun_can_build_skb() to tun_build_skb() to
  remove duplication and locking issue, and also drop the packet in
  case of a failed check - noted by Jason Wang <jasowang@redhat.com>
