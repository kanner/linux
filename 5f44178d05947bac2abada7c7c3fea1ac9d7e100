v5:
  - use rcu_access_pointer() instead of rcu_read_lock/unlock() to check
    if xdp_prog is set since there's no further dereference, noted by
    David Ahern <dsahern@gmail.com>
v4: https://lore.kernel.org/all/20230801220710.464-1-andrew.kanner@gmail.com/T/
  - fall back to v1, fixing only missing XDP_PACKET_HEADROOM in pad and
    removing bpf_xdp_adjust_tail() check for frame_sz.
  - added rcu read lock, noted by Jason Wang <jasowang@redhat.com> in v1
  - I decided to leave the packet length check in tun_can_build_skb()
    instead of moving to tun_build_skb() suggested by Jason Wang
    <jasowang@redhat.com>. Otherwise extra packets will be dropped
    without falling back to tun_alloc_skb(). And in the discussion of v3
    Jesper Dangaard Brouer <jbrouer@redhat.com> noticed that XDP is ok
    with a higher order pages if it's a contiguous physical memory
    allocation, so falling to tun_alloc_skb() -> do_xdp_generic() should
    be ok.
v3: https://lore.kernel.org/all/20230725155403.796-1-andrew.kanner@gmail.com/T/
  - attach the forgotten changelog
v2: https://lore.kernel.org/all/20230725153941.653-1-andrew.kanner@gmail.com/T/
  - merged 2 patches in 1, fixing both issues: WARN_ON_ONCE with
    syzkaller repro and missing XDP_PACKET_HEADROOM in pad
  - changed the title and description of the execution path, suggested
    by Jason Wang <jasowang@redhat.com>
  - move the limit check from tun_can_build_skb() to tun_build_skb() to
    remove duplication and locking issue, and also drop the packet in
    case of a failed check - noted by Jason Wang <jasowang@redhat.com>
v1: https://lore.kernel.org/all/20230724221326.384-1-andrew.kanner@gmail.com/T/
